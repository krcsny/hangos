{
  "version": 3,
  "file": "client.js",
  "sourceRoot": "",
  "sources": [
    "client.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "Samples = \n  numbers : []\n  back : null\n  empty : null\n  buffercount : 0\n  loadcount : 1\n  loadedBuffer : () ->\n    @loadcount += 1\n    # $(\"#time\").html ($(\"#time\").html() + \".\")\n    pc = Math.floor((@loadcount / (@buffercount+1)) * 100)\n    $(\"#time\").html \"#{pc}%\"\n  urlExists : (url) ->\n    http = new XMLHttpRequest()\n    http.open('HEAD', url, false)\n    http.send()\n    http.status isnt 404\n  get : (url) ->\n    if @urlExists url\n      @buffercount += 1\n      new Tone.Buffer(url, @loadedBuffer.bind(@))\n    else @empty\n  load : (callback) ->\n    @empty = @get \"./samples/_empty.mp3\"\n    @back = @get \"./samples/vissza.mp3\"\n    for i in [0..9]\n      @numbers.push @get(\"./samples/#{i}.mp3\")  \n    Map.load Mapdata #HACK\n    Looper.load @loadedBuffer.bind(@)\n    Tone.Buffer.on \"load\", callback\n\nclass Menu\n  constructor : (params) ->\n    @name = params[0]\n    @parent = params[1]\n    @outputs = params[2]\n    @info = params[3]\n    @getOutput = (i) -> if i < @outputs.length then @outputs[i] else null\n    @info_buffer = Samples.get \"./samples/#{@name}_info.mp3\"\n    @content_buffer = Samples.get \"./samples/#{@name}.mp3\"\n    @isLooper = () -> @name.substr(0, 6) is \"looper\"\n    @isStory = () -> @name.substr(0, 2) is \"k_\"\n\n  toString : () ->\n    outs = \n      for o, i in @outputs\n        if Map.nodes[o]?\n          \"#{i + 1} : #{Map.nodes[o].info}\"\n        else \n          \"\"\n    @info + \"\\n\" + outs.join \"\\n\"\n\nclass Track\n  constructor : () ->\n    @player = new Tone.Player(loop : true, volume : -6).connect Tone.Master\n  toggle : () -> @player.mute = !@player.mute\n\nLooper = \n  tracks : [0..8].map((i) -> new Track())\n  songs : []\n  current : 0\n  load : (onload) ->\n    for s in [1..6]\n      @songs.push(\n        for t in [1..9]\n          Samples.get \"./samples/looper/#{s}/#{t}.mp3\"\n      ) \n  start : () -> @tracks.map((t) -> t.player.start())\n  stop : () -> @tracks.map((t) -> t.player.stop())\n\n  init : (s) ->\n    for t, i in @tracks\n      t.player.buffer = @songs[s - 1][i]\n      t.player.mute = i isnt 0\n    Looper.start()\n  toggle : (i) ->\n    if 0 < i < @tracks.length + 1\n      @tracks[i - 1].toggle()      \n\nVisual = \n  mode : \"wave\" # \"wave\"\n  waveform : null\n  ctx : null\n  hsl : (h, s, l, a) -> \n   \"hsl(#{h * 360}, #{s * 100}%, #{l * 100}%, #{a})\"\n  loops : (w, h) ->\n    sw = w / 3\n    sh = h / 3\n    for l in [0..8]\n      @ctx.fillStyle = \n        if Looper.tracks[l].player.mute\n          \"#6244\"\n        else\n          @hsl 0.9 + Math.random() * 0.2, 0.8 + Math.random() * 0.1, 0.3, 0.2 + Math.random() * 0.2\n      @ctx.fillRect((l % 3) * sw, Math.floor(l / 3) * sh, sw, sh)\n  drawWaveform : (values) ->\n    w = @ctx.canvas.width\n    h =  @ctx.canvas.height\n    # @ctx.clearRect(0, 0, w, h)\n    @ctx.fillStyle = \"#6244\"\n    @ctx.fillRect(0, 0, w, h)\n    if Map.current? and Map.current.isLooper()\n      @loops w, h\n    @ctx.lineJoin = \"bezel\"\n    segment = 128\n    for part in [0..7]\n      @ctx.lineWidth = 1 + values[0] * (15 + Math.random() * 5)\n      @ctx.strokeStyle = @hsl 0.9 + Math.random() * 0.2, 0.8 + Math.random() * 0.1, 0.5, 0.5 # \"d48\"\n      @ctx.beginPath()\n      @ctx.moveTo(0, 0.5 * h)\n      for i in [0..segment - 1]    \n        val = (values[part * segment + i] + 1) / 2\n        x = w * ((i % segment) / segment)\n        y = val * 2 * h - h * 0.5\n        @ctx.lineTo(x, y)\n      @ctx.lineTo(w, 0.5 * h)\n      @ctx.stroke()\n  draw : () ->\n    @drawWaveform(@waveform.getValue());\n    requestAnimationFrame(Visual.draw.bind(Visual));\n  write : (text) ->\n    # if @mode is \"text\"\n    $(\"#text\").html text\n  resize : () ->\n    @ctx.canvas.width = $(\"#screen\").width()\n    @ctx.canvas.height = $(\"#screen\").height()\n  init : () ->\n    if @mode is \"wave\"\n      @waveform = new Tone.Waveform(1024)\n      Tone.Master.fan @waveform\n      @ctx = $(\"canvas\").get(0).getContext(\"2d\")\n      $(window).resize Visual.resize\n      @resize()\n      @draw()\n\nPlayer = \n  player : null\n  playlist : null\n  init : () ->\n    @player = new Tone.Player().toMaster()\n  reset : () ->\n    Tone.Transport.seconds = 0\n    Tone.Transport.start()\n    if @playlist?\n      @player.stop()\n      @playlist.removeAll()\n      # @playlist.dispose()\n  play : (node, nointro) ->\n    @reset()\n    # Tone.Transport.seconds = 3\n    if node.outputs.length is 0\n      # DEAD END\n      buffer = node.content_buffer\n      # if node.name is \"m_kapcsolat\" then pickRandom\n      @playlist = new Tone.Part(\n        ((t, o) ->\n          if !o.buffer?\n            Map.switchTo node.parent\n          else\n            @player.buffer = o.buffer\n            @player.start()\n        ).bind(@),\n        [\n          {time:0, buffer:buffer}, \n          {time:buffer.duration}\n        ]\n      )\n    else\n      # CLASSIC\n      addDurations = (_a, _v) -> _a + _v.buffer.duration\n      timetable = node.outputs.reduce(\n        ((list, output, i) ->\n          list.concat([\n            {\n              time : list.reduce(addDurations, 0)\n              buffer : Map.nodes[output].info_buffer\n            }\n            {\n              time : list.reduce(addDurations, 0) + Map.nodes[output].info_buffer.duration\n              buffer : Samples.numbers[i + 1]\n            }\n            ]\n          )\n        ), (if nointro then [] else [{time : 0, buffer : node.content_buffer}] ))\n      if node.name isnt \"_\" and not node.isStory()\n        timetable.push({time : timetable.reduce(addDurations, 0), buffer : Samples.back})\n      last = timetable[timetable.length - 1]\n      ending_time = last.time + last.buffer.duration\n      @playlist = new Tone.Part(\n        ((t, o) ->\n          if !o.buffer? #HACK\n            Phone.lastAction = Phone.now()\n          else\n            @player.buffer = o.buffer\n            @player.start()\n        ).bind(@), \n        timetable.concat([{time:ending_time}])\n      )\n    @playlist.start(0.1)\n\nMap = \n  startmenu : \"_\"\n  nodes : {}\n  history : null\n  current : null\n  load : (data) ->    \n    for d in data\n      @nodes[d[0]] = new Menu d\n  switchTo : (next, nointro) ->\n    node = @nodes[next]\n    if node.outputs.length is 1 and node.outputs[0].substr(0, 2) is \"->\"\n      # INSTANT FLOW\n      @switchTo node.outputs[0].substr(2), false\n    else\n      if @current? and @current.isLooper()\n        Looper.stop()\n\n      @current = node\n\n      if @current.isLooper()\n        Player.reset()\n        Looper.init(parseInt next.substr(6,1))\n      else\n        Player.play node, nointro\n\n      @history.actions.push next\n\n      Visual.write @current.toString()\n  start : () ->\n    @history = \n      start_time : new Date().toString()\n      actions : []\n    @switchTo @startmenu, false\n  end : () ->\n    @current = null\n    @history.end_time = new Date().toString()\n\nPhone = \n  oncall : false\n  lastAction : -1\n  now : (time) -> \n    if time then new Date(time).getTime() \n    else new Date().getTime()\n  init : () ->\n    $(\"#phone\").css \"display\", \"flex\"\n    $(\"#phone\").animate(\n      top : 0\n      opacity : 1\n    )\n    $(\"#time\").animate(\n      top : \"-100%\"\n      opacity : 0\n    )\n\n    $(window).keydown((e) ->\n      if \"0123456789#*abcd\".indexOf(e.key.toLowerCase()) isnt -1\n        Phone.dial e.key\n    )\n    $(\".numpad\").click((e)-> \n      k = e.currentTarget.innerHTML\n      $(e.currentTarget).css(\"transform\", \"scale(0.9)\")\n      setTimeout((() -> $(e.currentTarget).css(\"transform\", \"scale(1.0)\")), 125)\n      encode k\n      Phone.dial k\n    )\n    $(\"#call\").click((e) ->\n      Player.player.context.resume()\n      Phone.pickup()\n    )\n  pickup : () ->\n    $(\"#call\").hide(250)\n    # $(\"#call\").css \"display\", \"none\"\n    if not @oncall\n      Player.player.context.resume()\n      @lastAction = -1\n      @oncall = true\n      Map.start()\n  hangup : () ->\n    Map.end()\n    Looper.stop()\n    @oncall = false\n    Player.reset()\n    Visual.write \"hanged up. \\npress CALL to start a new call\"\n    $(\"#call\").css \"display\", \"block\"\n    Server.history Map.history\n  dial : (k) ->\n    if @oncall\n      @lastAction = @now()\n      action = {digit : k}\n      switch k\n        when 'C' then @hangup()\n        when '*'\n          if Map.current.parent isnt Map.current.name and not Map.current.isStory()\n            Map.switchTo Map.current.parent, true\n        when '#' then Map.switchTo Map.startmenu # repeat menu items\n        when '0','1','2','3','4','5','6','7','8','9'\n          if Map.current? and Map.current.isLooper()\n            Looper.toggle parseInt(k)\n          else\n            next = Map.current.getOutput (if k is 0 then 0 else k - 1)\n            if next?\n              Map.switchTo next, false\n    else\n      if k is 'A'\n        @pickup()\n\nServer = \n  socket : null\n  init : () -> \n    @socket = io()\n    # if @socket.connected\n    @socket.on \"incomingDigit\", Phone.dial.bind(Phone)\n    @socket.on \"hangup\", Phone.hangup.bind(Phone)\n    @socket.on \"pickup\", Phone.pickup.bind(Phone)\n    # else \n    #   @socket.disconnect()\n  history : (history) ->  \n    if @socket.connected\n      @socket.emit \"history\", history\n\ninit = () ->\n  Player.init()\n  Phone.init()\n  Server.init()\n  Visual.init()\n\nSamples.load init\n\n# IdleWatcher = null\n# IdleWatcher = window.setInterval(watchIdle, 1000)\n\n# watchIdle = () ->\n#   kickTime = 60000\n#   millisToSec = (ms) -> Math.abs(Math.floor(0.001 * ms)) + \"s\"\n#   t = \"\"\n#   if not Phone.oncall and Map.history?\n#     t = \"last call was \" + millisToSec(Phone.now() - Phone.now(Map.history.end_time)) + \" ago\"\n#   else if Phone.oncall\n#     et = millisToSec(Phone.now() - Phone.now(Map.history.start_time))\n#     t = \"call time : #{et}\"\n#   if LastTimePartEnded isnt -1\n#     kt = millisToSec(Phone.now() - (LastTimePartEnded + kickTime) )\n#     t = t + \"  --- hanging up in : #{kt}\"\n#     if Phone.now() > LastTimePartEnded + kickTime\n#       hangup()\n#   $(\"#time\").html t\n\n\n###\nTODO\nlooper 5 fix clipping sample\n###\n"
  ]
}